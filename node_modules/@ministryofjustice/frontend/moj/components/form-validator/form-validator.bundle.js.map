{"version":3,"file":"form-validator.bundle.js","sources":["../../../../src/moj/helpers.mjs","../../../../src/moj/components/form-validator/form-validator.mjs"],"sourcesContent":["/**\n * @param {Element} $element - Element to remove attribute value from\n * @param {string} attr - Attribute name\n * @param {string} value - Attribute value\n */\nexport function removeAttributeValue($element, attr, value) {\n  let re, m\n  if ($element.getAttribute(attr)) {\n    if ($element.getAttribute(attr) === value) {\n      $element.removeAttribute(attr)\n    } else {\n      re = new RegExp(`(^|\\\\s)${value}(\\\\s|$)`)\n      m = $element.getAttribute(attr).match(re)\n      if (m && m.length === 3) {\n        $element.setAttribute(\n          attr,\n          $element.getAttribute(attr).replace(re, m[1] && m[2] ? ' ' : '')\n        )\n      }\n    }\n  }\n}\n\n/**\n * @param {Element} $element - Element to add attribute value to\n * @param {string} attr - Attribute name\n * @param {string} value - Attribute value\n */\nexport function addAttributeValue($element, attr, value) {\n  let re\n  if (!$element.getAttribute(attr)) {\n    $element.setAttribute(attr, value)\n  } else {\n    re = new RegExp(`(^|\\\\s)${value}(\\\\s|$)`)\n    if (!re.test($element.getAttribute(attr))) {\n      $element.setAttribute(attr, `${$element.getAttribute(attr)} ${value}`)\n    }\n  }\n}\n\n/**\n * Find an elements next sibling\n *\n * Utility function to find an elements next sibling matching the provided\n * selector.\n *\n * @param {Element | null} $element - Element to find siblings for\n * @param {string} [selector] - selector for required sibling\n */\nexport function getNextSibling($element, selector) {\n  if (!$element || !($element instanceof HTMLElement)) {\n    return\n  }\n\n  // Get the next sibling element\n  let $sibling = $element.nextElementSibling\n\n  // If there's no selector, return the first sibling\n  if (!selector) return $sibling\n\n  // If the sibling matches our selector, use it\n  // If not, jump to the next sibling and continue the loop\n  while ($sibling) {\n    if ($sibling.matches(selector)) return $sibling\n    $sibling = $sibling.nextElementSibling\n  }\n}\n\n/**\n * Find an elements preceding sibling\n *\n * Utility function to find an elements previous sibling matching the provided\n * selector.\n *\n * @param {Element | null} $element - Element to find siblings for\n * @param {string} [selector] - selector for required sibling\n */\nexport function getPreviousSibling($element, selector) {\n  if (!$element || !($element instanceof HTMLElement)) {\n    return\n  }\n\n  // Get the previous sibling element\n  let $sibling = $element.previousElementSibling\n\n  // If there's no selector, return the first sibling\n  if (!selector) return $sibling\n\n  // If the sibling matches our selector, use it\n  // If not, jump to the next sibling and continue the loop\n  while ($sibling) {\n    if ($sibling.matches(selector)) return $sibling\n    $sibling = $sibling.previousElementSibling\n  }\n}\n\n/**\n * @param {Element | null} $element\n * @param {string} [selector]\n */\nexport function findNearestMatchingElement($element, selector) {\n  // If no element or selector is provided, return\n  if (!$element || !($element instanceof HTMLElement) || !selector) {\n    return\n  }\n\n  // Start with the current element\n  let $currentElement = $element\n\n  while ($currentElement) {\n    // First check the current element\n    if ($currentElement.matches(selector)) {\n      return $currentElement\n    }\n\n    // Check all previous siblings\n    let $sibling = $currentElement.previousElementSibling\n    while ($sibling) {\n      // Check if the sibling itself is a heading\n      if ($sibling.matches(selector)) {\n        return $sibling\n      }\n      $sibling = $sibling.previousElementSibling\n    }\n\n    // If no match found in siblings, move up to parent\n    $currentElement = $currentElement.parentElement\n  }\n}\n","import { ConfigurableComponent } from 'govuk-frontend'\n\nimport { addAttributeValue, removeAttributeValue } from '../../helpers.mjs'\n\n/**\n * @augments {ConfigurableComponent<FormValidatorConfig, HTMLFormElement>}\n */\nexport class FormValidator extends ConfigurableComponent {\n  /**\n   * @param {Element | null} $root - HTML element to use for form validator\n   * @param {FormValidatorConfig} [config] - Form validator config\n   */\n  constructor($root, config = {}) {\n    super($root, config)\n\n    const $summary =\n      this.config.summary.element ||\n      document.querySelector(this.config.summary.selector)\n\n    if (!$summary || !($summary instanceof HTMLElement)) {\n      return this\n    }\n\n    this.$summary = $summary\n\n    this.errors = /** @type {ValidationError[]} */ ([])\n    this.validators = /** @type {Validator[]} */ ([])\n    this.originalTitle = document.title\n\n    this.$root.addEventListener('submit', this.onSubmit.bind(this))\n  }\n\n  escapeHtml(string = '') {\n    return String(string).replace(\n      /[&<>\"'`=/]/g,\n      (name) => FormValidator.entityMap[name]\n    )\n  }\n\n  resetTitle() {\n    document.title = this.originalTitle\n  }\n\n  updateTitle() {\n    document.title = `${this.errors.length} errors - ${document.title}`\n  }\n\n  showSummary() {\n    this.$summary.innerHTML = this.getSummaryHtml()\n    this.$summary.classList.remove('moj-hidden')\n    this.$summary.setAttribute('aria-labelledby', 'errorSummary-heading')\n    this.$summary.focus()\n  }\n\n  getSummaryHtml() {\n    let html =\n      '<h2 id=\"error-summary-title\" class=\"govuk-error-summary__title\">There is a problem</h2>'\n    html += '<div class=\"govuk-error-summary__body\">'\n    html += '<ul class=\"govuk-list govuk-error-summary__list\">'\n    for (const error of this.errors) {\n      html += '<li>'\n      html += `<a href=\"#${this.escapeHtml(error.fieldName)}\">`\n      html += this.escapeHtml(error.message)\n      html += '</a>'\n      html += '</li>'\n    }\n    html += '</ul>'\n    html += '</div>'\n    return html\n  }\n\n  hideSummary() {\n    this.$summary.classList.add('moj-hidden')\n    this.$summary.removeAttribute('aria-labelledby')\n  }\n\n  /**\n   * @param {SubmitEvent} event - Form submit event\n   */\n  onSubmit(event) {\n    this.removeInlineErrors()\n    this.hideSummary()\n    this.resetTitle()\n    if (!this.validate()) {\n      event.preventDefault()\n      this.updateTitle()\n      this.showSummary()\n      this.showInlineErrors()\n    }\n  }\n\n  showInlineErrors() {\n    for (const error of this.errors) {\n      this.showInlineError(error)\n    }\n  }\n\n  /**\n   * @param {ValidationError} error\n   */\n  showInlineError(error) {\n    const $errorSpan = document.createElement('span')\n    $errorSpan.id = `${error.fieldName}-error`\n    $errorSpan.classList.add('govuk-error-message')\n    $errorSpan.innerHTML = this.escapeHtml(error.message)\n\n    const $control = document.querySelector(`#${error.fieldName}`)\n    const $fieldset = $control.closest('.govuk-fieldset')\n    const $fieldContainer = ($fieldset || $control).closest('.govuk-form-group')\n\n    const $label = $fieldContainer.querySelector('label')\n    const $legend = $fieldContainer.querySelector('legend')\n\n    $fieldContainer.classList.add('govuk-form-group--error')\n\n    if ($fieldset && $legend) {\n      $legend.after($errorSpan)\n      $fieldContainer.setAttribute('aria-invalid', 'true')\n      addAttributeValue($fieldset, 'aria-describedby', $errorSpan.id)\n    } else if ($label && $control) {\n      $label.after($errorSpan)\n      $control.setAttribute('aria-invalid', 'true')\n      addAttributeValue($control, 'aria-describedby', $errorSpan.id)\n    }\n  }\n\n  removeInlineErrors() {\n    for (const error of this.errors) {\n      this.removeInlineError(error)\n    }\n  }\n\n  /**\n   * @param {ValidationError} error\n   */\n  removeInlineError(error) {\n    const $errorSpan = document.querySelector(`#${error.fieldName}-error`)\n\n    const $control = document.querySelector(`#${error.fieldName}`)\n    const $fieldset = $control.closest('.govuk-fieldset')\n    const $fieldContainer = ($fieldset || $control).closest('.govuk-form-group')\n\n    const $label = $fieldContainer.querySelector('label')\n    const $legend = $fieldContainer.querySelector('legend')\n\n    $errorSpan.remove()\n    $fieldContainer.classList.remove('govuk-form-group--error')\n\n    if ($fieldset && $legend) {\n      $fieldContainer.removeAttribute('aria-invalid')\n      removeAttributeValue($fieldset, 'aria-describedby', $errorSpan.id)\n    } else if ($label && $control) {\n      $control.removeAttribute('aria-invalid')\n      removeAttributeValue($control, 'aria-describedby', $errorSpan.id)\n    }\n  }\n\n  /**\n   * @param {string} fieldName - Field name\n   * @param {ValidationRule[]} rules - Validation rules\n   */\n  addValidator(fieldName, rules) {\n    this.validators.push({\n      fieldName,\n      rules,\n      field: this.$root.elements.namedItem(fieldName)\n    })\n  }\n\n  validate() {\n    this.errors = []\n\n    /** @type {Validator | null} */\n    let validator = null\n\n    /** @type {boolean | string} */\n    let validatorReturnValue = true\n\n    let i\n    let j\n\n    for (i = 0; i < this.validators.length; i++) {\n      validator = this.validators[i]\n      for (j = 0; j < validator.rules.length; j++) {\n        validatorReturnValue = validator.rules[j].method(\n          validator.field,\n          validator.rules[j].params\n        )\n\n        if (\n          typeof validatorReturnValue === 'boolean' &&\n          !validatorReturnValue\n        ) {\n          this.errors.push({\n            fieldName: validator.fieldName,\n            message: validator.rules[j].message\n          })\n          break\n        } else if (typeof validatorReturnValue === 'string') {\n          this.errors.push({\n            fieldName: validatorReturnValue,\n            message: validator.rules[j].message\n          })\n          break\n        }\n      }\n    }\n    return this.errors.length === 0\n  }\n\n  /**\n   * @type {Record<string, string>}\n   */\n  static entityMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '/': '&#x2F;',\n    '`': '&#x60;',\n    '=': '&#x3D;'\n  }\n\n  /**\n   * Name for the component used when initialising using data-module attributes.\n   */\n  static moduleName = 'moj-form-validator'\n\n  /**\n   * Multi file upload default config\n   *\n   * @type {FormValidatorConfig}\n   */\n  static defaults = Object.freeze({\n    summary: {\n      selector: '.govuk-error-summary'\n    }\n  })\n\n  /**\n   * Multi file upload config schema\n   *\n   * @satisfies {Schema<FormValidatorConfig>}\n   */\n  static schema = Object.freeze(\n    /** @type {const} */ ({\n      properties: {\n        summary: { type: 'object' }\n      }\n    })\n  )\n}\n\n/**\n * @typedef {object} FormValidatorConfig\n * @property {object} [summary] - Error summary config\n * @property {string} [summary.selector] - Selector for error summary\n * @property {Element | null} [summary.element] - HTML element for error summary\n */\n\n/**\n * @typedef {object} ValidationRule\n * @property {(field: Validator['field'], params: Record<string, Validator['field']>) => boolean | string} method - Validation method\n * @property {string} message - Error message\n * @property {Record<string, Validator['field']>} [params] - Parameters for validation\n */\n\n/**\n * @typedef {object} ValidationError\n * @property {string} fieldName - Name of the field\n * @property {string} message - Validation error message\n */\n\n/**\n * @typedef {object} Validator\n * @property {string} fieldName - Name of the field\n * @property {ValidationRule[]} rules - Validation rules\n * @property {Element | RadioNodeList} field - Form field\n */\n\n/**\n * @import { Schema } from 'govuk-frontend/dist/govuk/common/configuration.mjs'\n */\n"],"names":["removeAttributeValue","$element","attr","value","re","m","getAttribute","removeAttribute","RegExp","match","length","setAttribute","replace","addAttributeValue","test","FormValidator","ConfigurableComponent","constructor","$root","config","$summary","summary","element","document","querySelector","selector","HTMLElement","errors","validators","originalTitle","title","addEventListener","onSubmit","bind","escapeHtml","string","String","name","entityMap","resetTitle","updateTitle","showSummary","innerHTML","getSummaryHtml","classList","remove","focus","html","error","fieldName","message","hideSummary","add","event","removeInlineErrors","validate","preventDefault","showInlineErrors","showInlineError","$errorSpan","createElement","id","$control","$fieldset","closest","$fieldContainer","$label","$legend","after","removeInlineError","addValidator","rules","push","field","elements","namedItem","validator","validatorReturnValue","i","j","method","params","moduleName","defaults","Object","freeze","schema","properties","type"],"mappings":";;;;;;EAAA;EACA;EACA;EACA;EACA;EACO,SAASA,oBAAoBA,CAACC,QAAQ,EAAEC,IAAI,EAAEC,KAAK,EAAE;IAC1D,IAAIC,EAAE,EAAEC,CAAC;EACT,EAAA,IAAIJ,QAAQ,CAACK,YAAY,CAACJ,IAAI,CAAC,EAAE;MAC/B,IAAID,QAAQ,CAACK,YAAY,CAACJ,IAAI,CAAC,KAAKC,KAAK,EAAE;EACzCF,MAAAA,QAAQ,CAACM,eAAe,CAACL,IAAI,CAAC;EAChC,KAAC,MAAM;EACLE,MAAAA,EAAE,GAAG,IAAII,MAAM,CAAC,CAAUL,OAAAA,EAAAA,KAAK,SAAS,CAAC;QACzCE,CAAC,GAAGJ,QAAQ,CAACK,YAAY,CAACJ,IAAI,CAAC,CAACO,KAAK,CAACL,EAAE,CAAC;EACzC,MAAA,IAAIC,CAAC,IAAIA,CAAC,CAACK,MAAM,KAAK,CAAC,EAAE;EACvBT,QAAAA,QAAQ,CAACU,YAAY,CACnBT,IAAI,EACJD,QAAQ,CAACK,YAAY,CAACJ,IAAI,CAAC,CAACU,OAAO,CAACR,EAAE,EAAEC,CAAC,CAAC,CAAC,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,EAAE,CACjE,CAAC;EACH;EACF;EACF;EACF;;EAEA;EACA;EACA;EACA;EACA;EACO,SAASQ,iBAAiBA,CAACZ,QAAQ,EAAEC,IAAI,EAAEC,KAAK,EAAE;EACvD,EAAA,IAAIC,EAAE;EACN,EAAA,IAAI,CAACH,QAAQ,CAACK,YAAY,CAACJ,IAAI,CAAC,EAAE;EAChCD,IAAAA,QAAQ,CAACU,YAAY,CAACT,IAAI,EAAEC,KAAK,CAAC;EACpC,GAAC,MAAM;EACLC,IAAAA,EAAE,GAAG,IAAII,MAAM,CAAC,CAAUL,OAAAA,EAAAA,KAAK,SAAS,CAAC;EACzC,IAAA,IAAI,CAACC,EAAE,CAACU,IAAI,CAACb,QAAQ,CAACK,YAAY,CAACJ,IAAI,CAAC,CAAC,EAAE;EACzCD,MAAAA,QAAQ,CAACU,YAAY,CAACT,IAAI,EAAE,CAAGD,EAAAA,QAAQ,CAACK,YAAY,CAACJ,IAAI,CAAC,CAAIC,CAAAA,EAAAA,KAAK,EAAE,CAAC;EACxE;EACF;EACF;;EClCA;EACA;EACA;EACO,MAAMY,aAAa,SAASC,mCAAqB,CAAC;EACvD;EACF;EACA;EACA;EACEC,EAAAA,WAAWA,CAACC,KAAK,EAAEC,MAAM,GAAG,EAAE,EAAE;EAC9B,IAAA,KAAK,CAACD,KAAK,EAAEC,MAAM,CAAC;MAEpB,MAAMC,QAAQ,GACZ,IAAI,CAACD,MAAM,CAACE,OAAO,CAACC,OAAO,IAC3BC,QAAQ,CAACC,aAAa,CAAC,IAAI,CAACL,MAAM,CAACE,OAAO,CAACI,QAAQ,CAAC;MAEtD,IAAI,CAACL,QAAQ,IAAI,EAAEA,QAAQ,YAAYM,WAAW,CAAC,EAAE;EACnD,MAAA,OAAO,IAAI;EACb;MAEA,IAAI,CAACN,QAAQ,GAAGA,QAAQ;EAExB,IAAA,IAAI,CAACO,MAAM,mCAAqC,EAAG;EACnD,IAAA,IAAI,CAACC,UAAU,6BAA+B,EAAG;EACjD,IAAA,IAAI,CAACC,aAAa,GAAGN,QAAQ,CAACO,KAAK;EAEnC,IAAA,IAAI,CAACZ,KAAK,CAACa,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAACC,QAAQ,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;EACjE;EAEAC,EAAAA,UAAUA,CAACC,MAAM,GAAG,EAAE,EAAE;EACtB,IAAA,OAAOC,MAAM,CAACD,MAAM,CAAC,CAACvB,OAAO,CAC3B,aAAa,EACZyB,IAAI,IAAKtB,aAAa,CAACuB,SAAS,CAACD,IAAI,CACxC,CAAC;EACH;EAEAE,EAAAA,UAAUA,GAAG;EACXhB,IAAAA,QAAQ,CAACO,KAAK,GAAG,IAAI,CAACD,aAAa;EACrC;EAEAW,EAAAA,WAAWA,GAAG;EACZjB,IAAAA,QAAQ,CAACO,KAAK,GAAG,CAAA,EAAG,IAAI,CAACH,MAAM,CAACjB,MAAM,CAAA,UAAA,EAAaa,QAAQ,CAACO,KAAK,CAAE,CAAA;EACrE;EAEAW,EAAAA,WAAWA,GAAG;MACZ,IAAI,CAACrB,QAAQ,CAACsB,SAAS,GAAG,IAAI,CAACC,cAAc,EAAE;MAC/C,IAAI,CAACvB,QAAQ,CAACwB,SAAS,CAACC,MAAM,CAAC,YAAY,CAAC;MAC5C,IAAI,CAACzB,QAAQ,CAACT,YAAY,CAAC,iBAAiB,EAAE,sBAAsB,CAAC;EACrE,IAAA,IAAI,CAACS,QAAQ,CAAC0B,KAAK,EAAE;EACvB;EAEAH,EAAAA,cAAcA,GAAG;MACf,IAAII,IAAI,GACN,yFAAyF;EAC3FA,IAAAA,IAAI,IAAI,yCAAyC;EACjDA,IAAAA,IAAI,IAAI,mDAAmD;EAC3D,IAAA,KAAK,MAAMC,KAAK,IAAI,IAAI,CAACrB,MAAM,EAAE;EAC/BoB,MAAAA,IAAI,IAAI,MAAM;QACdA,IAAI,IAAI,CAAa,UAAA,EAAA,IAAI,CAACb,UAAU,CAACc,KAAK,CAACC,SAAS,CAAC,CAAI,EAAA,CAAA;QACzDF,IAAI,IAAI,IAAI,CAACb,UAAU,CAACc,KAAK,CAACE,OAAO,CAAC;EACtCH,MAAAA,IAAI,IAAI,MAAM;EACdA,MAAAA,IAAI,IAAI,OAAO;EACjB;EACAA,IAAAA,IAAI,IAAI,OAAO;EACfA,IAAAA,IAAI,IAAI,QAAQ;EAChB,IAAA,OAAOA,IAAI;EACb;EAEAI,EAAAA,WAAWA,GAAG;MACZ,IAAI,CAAC/B,QAAQ,CAACwB,SAAS,CAACQ,GAAG,CAAC,YAAY,CAAC;EACzC,IAAA,IAAI,CAAChC,QAAQ,CAACb,eAAe,CAAC,iBAAiB,CAAC;EAClD;;EAEA;EACF;EACA;IACEyB,QAAQA,CAACqB,KAAK,EAAE;MACd,IAAI,CAACC,kBAAkB,EAAE;MACzB,IAAI,CAACH,WAAW,EAAE;MAClB,IAAI,CAACZ,UAAU,EAAE;EACjB,IAAA,IAAI,CAAC,IAAI,CAACgB,QAAQ,EAAE,EAAE;QACpBF,KAAK,CAACG,cAAc,EAAE;QACtB,IAAI,CAAChB,WAAW,EAAE;QAClB,IAAI,CAACC,WAAW,EAAE;QAClB,IAAI,CAACgB,gBAAgB,EAAE;EACzB;EACF;EAEAA,EAAAA,gBAAgBA,GAAG;EACjB,IAAA,KAAK,MAAMT,KAAK,IAAI,IAAI,CAACrB,MAAM,EAAE;EAC/B,MAAA,IAAI,CAAC+B,eAAe,CAACV,KAAK,CAAC;EAC7B;EACF;;EAEA;EACF;EACA;IACEU,eAAeA,CAACV,KAAK,EAAE;EACrB,IAAA,MAAMW,UAAU,GAAGpC,QAAQ,CAACqC,aAAa,CAAC,MAAM,CAAC;EACjDD,IAAAA,UAAU,CAACE,EAAE,GAAG,GAAGb,KAAK,CAACC,SAAS,CAAQ,MAAA,CAAA;EAC1CU,IAAAA,UAAU,CAACf,SAAS,CAACQ,GAAG,CAAC,qBAAqB,CAAC;MAC/CO,UAAU,CAACjB,SAAS,GAAG,IAAI,CAACR,UAAU,CAACc,KAAK,CAACE,OAAO,CAAC;MAErD,MAAMY,QAAQ,GAAGvC,QAAQ,CAACC,aAAa,CAAC,CAAA,CAAA,EAAIwB,KAAK,CAACC,SAAS,CAAA,CAAE,CAAC;EAC9D,IAAA,MAAMc,SAAS,GAAGD,QAAQ,CAACE,OAAO,CAAC,iBAAiB,CAAC;MACrD,MAAMC,eAAe,GAAG,CAACF,SAAS,IAAID,QAAQ,EAAEE,OAAO,CAAC,mBAAmB,CAAC;EAE5E,IAAA,MAAME,MAAM,GAAGD,eAAe,CAACzC,aAAa,CAAC,OAAO,CAAC;EACrD,IAAA,MAAM2C,OAAO,GAAGF,eAAe,CAACzC,aAAa,CAAC,QAAQ,CAAC;EAEvDyC,IAAAA,eAAe,CAACrB,SAAS,CAACQ,GAAG,CAAC,yBAAyB,CAAC;MAExD,IAAIW,SAAS,IAAII,OAAO,EAAE;EACxBA,MAAAA,OAAO,CAACC,KAAK,CAACT,UAAU,CAAC;EACzBM,MAAAA,eAAe,CAACtD,YAAY,CAAC,cAAc,EAAE,MAAM,CAAC;QACpDE,iBAAiB,CAACkD,SAAS,EAAE,kBAAkB,EAAEJ,UAAU,CAACE,EAAE,CAAC;EACjE,KAAC,MAAM,IAAIK,MAAM,IAAIJ,QAAQ,EAAE;EAC7BI,MAAAA,MAAM,CAACE,KAAK,CAACT,UAAU,CAAC;EACxBG,MAAAA,QAAQ,CAACnD,YAAY,CAAC,cAAc,EAAE,MAAM,CAAC;QAC7CE,iBAAiB,CAACiD,QAAQ,EAAE,kBAAkB,EAAEH,UAAU,CAACE,EAAE,CAAC;EAChE;EACF;EAEAP,EAAAA,kBAAkBA,GAAG;EACnB,IAAA,KAAK,MAAMN,KAAK,IAAI,IAAI,CAACrB,MAAM,EAAE;EAC/B,MAAA,IAAI,CAAC0C,iBAAiB,CAACrB,KAAK,CAAC;EAC/B;EACF;;EAEA;EACF;EACA;IACEqB,iBAAiBA,CAACrB,KAAK,EAAE;MACvB,MAAMW,UAAU,GAAGpC,QAAQ,CAACC,aAAa,CAAC,CAAA,CAAA,EAAIwB,KAAK,CAACC,SAAS,CAAA,MAAA,CAAQ,CAAC;MAEtE,MAAMa,QAAQ,GAAGvC,QAAQ,CAACC,aAAa,CAAC,CAAA,CAAA,EAAIwB,KAAK,CAACC,SAAS,CAAA,CAAE,CAAC;EAC9D,IAAA,MAAMc,SAAS,GAAGD,QAAQ,CAACE,OAAO,CAAC,iBAAiB,CAAC;MACrD,MAAMC,eAAe,GAAG,CAACF,SAAS,IAAID,QAAQ,EAAEE,OAAO,CAAC,mBAAmB,CAAC;EAE5E,IAAA,MAAME,MAAM,GAAGD,eAAe,CAACzC,aAAa,CAAC,OAAO,CAAC;EACrD,IAAA,MAAM2C,OAAO,GAAGF,eAAe,CAACzC,aAAa,CAAC,QAAQ,CAAC;MAEvDmC,UAAU,CAACd,MAAM,EAAE;EACnBoB,IAAAA,eAAe,CAACrB,SAAS,CAACC,MAAM,CAAC,yBAAyB,CAAC;MAE3D,IAAIkB,SAAS,IAAII,OAAO,EAAE;EACxBF,MAAAA,eAAe,CAAC1D,eAAe,CAAC,cAAc,CAAC;QAC/CP,oBAAoB,CAAC+D,SAAS,EAAE,kBAAkB,EAAEJ,UAAU,CAACE,EAAE,CAAC;EACpE,KAAC,MAAM,IAAIK,MAAM,IAAIJ,QAAQ,EAAE;EAC7BA,MAAAA,QAAQ,CAACvD,eAAe,CAAC,cAAc,CAAC;QACxCP,oBAAoB,CAAC8D,QAAQ,EAAE,kBAAkB,EAAEH,UAAU,CAACE,EAAE,CAAC;EACnE;EACF;;EAEA;EACF;EACA;EACA;EACES,EAAAA,YAAYA,CAACrB,SAAS,EAAEsB,KAAK,EAAE;EAC7B,IAAA,IAAI,CAAC3C,UAAU,CAAC4C,IAAI,CAAC;QACnBvB,SAAS;QACTsB,KAAK;QACLE,KAAK,EAAE,IAAI,CAACvD,KAAK,CAACwD,QAAQ,CAACC,SAAS,CAAC1B,SAAS;EAChD,KAAC,CAAC;EACJ;EAEAM,EAAAA,QAAQA,GAAG;MACT,IAAI,CAAC5B,MAAM,GAAG,EAAE;;EAEhB;MACA,IAAIiD,SAAS,GAAG,IAAI;;EAEpB;MACA,IAAIC,oBAAoB,GAAG,IAAI;EAE/B,IAAA,IAAIC,CAAC;EACL,IAAA,IAAIC,CAAC;EAEL,IAAA,KAAKD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAClD,UAAU,CAAClB,MAAM,EAAEoE,CAAC,EAAE,EAAE;EAC3CF,MAAAA,SAAS,GAAG,IAAI,CAAChD,UAAU,CAACkD,CAAC,CAAC;EAC9B,MAAA,KAAKC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,SAAS,CAACL,KAAK,CAAC7D,MAAM,EAAEqE,CAAC,EAAE,EAAE;UAC3CF,oBAAoB,GAAGD,SAAS,CAACL,KAAK,CAACQ,CAAC,CAAC,CAACC,MAAM,CAC9CJ,SAAS,CAACH,KAAK,EACfG,SAAS,CAACL,KAAK,CAACQ,CAAC,CAAC,CAACE,MACrB,CAAC;EAED,QAAA,IACE,OAAOJ,oBAAoB,KAAK,SAAS,IACzC,CAACA,oBAAoB,EACrB;EACA,UAAA,IAAI,CAAClD,MAAM,CAAC6C,IAAI,CAAC;cACfvB,SAAS,EAAE2B,SAAS,CAAC3B,SAAS;EAC9BC,YAAAA,OAAO,EAAE0B,SAAS,CAACL,KAAK,CAACQ,CAAC,CAAC,CAAC7B;EAC9B,WAAC,CAAC;EACF,UAAA;EACF,SAAC,MAAM,IAAI,OAAO2B,oBAAoB,KAAK,QAAQ,EAAE;EACnD,UAAA,IAAI,CAAClD,MAAM,CAAC6C,IAAI,CAAC;EACfvB,YAAAA,SAAS,EAAE4B,oBAAoB;EAC/B3B,YAAAA,OAAO,EAAE0B,SAAS,CAACL,KAAK,CAACQ,CAAC,CAAC,CAAC7B;EAC9B,WAAC,CAAC;EACF,UAAA;EACF;EACF;EACF;EACA,IAAA,OAAO,IAAI,CAACvB,MAAM,CAACjB,MAAM,KAAK,CAAC;EACjC;;EAEA;EACF;EACA;EAwCA;;EAEA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EApRaK,aAAa,CA8MjBuB,SAAS,GAAG;EACjB,EAAA,GAAG,EAAE,OAAO;EACZ,EAAA,GAAG,EAAE,MAAM;EACX,EAAA,GAAG,EAAE,MAAM;EACX,EAAA,GAAG,EAAE,QAAQ;EACb,EAAA,GAAG,EAAE,OAAO;EACZ,EAAA,GAAG,EAAE,QAAQ;EACb,EAAA,GAAG,EAAE,QAAQ;EACb,EAAA,GAAG,EAAE;EACP,CAAC;EAED;EACF;EACA;EA3NavB,aAAa,CA4NjBmE,UAAU,GAAG,oBAAoB;EAExC;EACF;EACA;EACA;EACA;EAlOanE,aAAa,CAmOjBoE,QAAQ,GAAGC,MAAM,CAACC,MAAM,CAAC;EAC9BhE,EAAAA,OAAO,EAAE;EACPI,IAAAA,QAAQ,EAAE;EACZ;EACF,CAAC,CAAC;EAEF;EACF;EACA;EACA;EACA;EA7OaV,aAAa,CA8OjBuE,MAAM,GAAGF,MAAM,CAACC,MAAM,qBACL;EACpBE,EAAAA,UAAU,EAAE;EACVlE,IAAAA,OAAO,EAAE;EAAEmE,MAAAA,IAAI,EAAE;EAAS;EAC5B;EACF,CACF,CAAC;;;;;;;;"}