{"version":3,"file":"multi-select.bundle.js","sources":["../../../../src/moj/components/multi-select/multi-select.mjs"],"sourcesContent":["import { ConfigurableComponent } from 'govuk-frontend'\n\n/**\n * @augments {ConfigurableComponent<MultiSelectConfig>}\n */\nexport class MultiSelect extends ConfigurableComponent {\n  /**\n   * @param {Element | null} $root - HTML element to use for multi select\n   * @param {MultiSelectConfig} [config] - Multi select config\n   */\n  constructor($root, config = {}) {\n    super($root, config)\n\n    const $container = this.$root.querySelector(\n      `#${this.config.idPrefix}select-all`\n    )\n\n    const $checkboxes = /** @type {NodeListOf<HTMLInputElement>} */ (\n      this.config.checkboxes.items ??\n        this.$root.querySelectorAll(this.config.checkboxes.selector)\n    )\n\n    if (\n      !$container ||\n      !($container instanceof HTMLElement) ||\n      !$checkboxes.length\n    ) {\n      return this\n    }\n\n    this.setupToggle(this.config.idPrefix)\n\n    this.$toggleButton = this.$toggle.querySelector('input')\n    this.$toggleButton.addEventListener('click', this.onButtonClick.bind(this))\n\n    this.$container = $container\n    this.$container.append(this.$toggle)\n\n    this.$checkboxes = Array.from($checkboxes)\n    this.$checkboxes.forEach(($input) =>\n      $input.addEventListener('click', this.onCheckboxClick.bind(this))\n    )\n\n    this.checked = config.checked || false\n  }\n\n  setupToggle(idPrefix = '') {\n    const id = `${idPrefix}checkboxes-all`\n\n    const $toggle = document.createElement('div')\n    const $label = document.createElement('label')\n    const $input = document.createElement('input')\n    const $span = document.createElement('span')\n\n    $toggle.classList.add(\n      'govuk-checkboxes__item',\n      'govuk-checkboxes--small',\n      'moj-multi-select__checkbox'\n    )\n\n    $input.id = id\n    $input.type = 'checkbox'\n    $input.classList.add('govuk-checkboxes__input')\n\n    $label.setAttribute('for', id)\n    $label.classList.add(\n      'govuk-label',\n      'govuk-checkboxes__label',\n      'moj-multi-select__toggle-label'\n    )\n\n    $span.classList.add('govuk-visually-hidden')\n    $span.textContent = 'Select all'\n\n    $label.append($span)\n    $toggle.append($input, $label)\n\n    this.$toggle = $toggle\n  }\n\n  onButtonClick() {\n    if (this.checked) {\n      this.uncheckAll()\n      this.$toggleButton.checked = false\n    } else {\n      this.checkAll()\n      this.$toggleButton.checked = true\n    }\n  }\n\n  checkAll() {\n    this.$checkboxes.forEach(($input) => {\n      $input.checked = true\n    })\n\n    this.checked = true\n  }\n\n  uncheckAll() {\n    this.$checkboxes.forEach(($input) => {\n      $input.checked = false\n    })\n\n    this.checked = false\n  }\n\n  /**\n   * @param {MouseEvent} event - Click event\n   */\n  onCheckboxClick(event) {\n    if (!(event.target instanceof HTMLInputElement)) {\n      return\n    }\n\n    if (!event.target.checked) {\n      this.$toggleButton.checked = false\n      this.checked = false\n    } else {\n      if (\n        this.$checkboxes.filter(($input) => $input.checked).length ===\n        this.$checkboxes.length\n      ) {\n        this.$toggleButton.checked = true\n        this.checked = true\n      }\n    }\n  }\n\n  /**\n   * Name for the component used when initialising using data-module attributes.\n   */\n  static moduleName = 'moj-multi-select'\n\n  /**\n   * Multi select config\n   *\n   * @type {MultiSelectConfig}\n   */\n  static defaults = Object.freeze({\n    idPrefix: '',\n    checkboxes: {\n      selector: 'tbody input.govuk-checkboxes__input'\n    }\n  })\n\n  /**\n   * Multi select config schema\n   *\n   * @satisfies {Schema<MultiSelectConfig>}\n   */\n  static schema = Object.freeze(\n    /** @type {const} */ ({\n      properties: {\n        idPrefix: { type: 'string' },\n        checked: { type: 'boolean' },\n        checkboxes: { type: 'object' }\n      }\n    })\n  )\n}\n\n/**\n * Multi select config\n *\n * @typedef {object} MultiSelectConfig\n * @property {string} [idPrefix] - Prefix for the Select all\" checkbox `id` attribute\n * @property {boolean} [checked] - Whether the \"Select all\" checkbox is checked\n * @property {object} [checkboxes] - Checkboxes config\n * @property {string} [checkboxes.selector] - Checkboxes query selector\n * @property {NodeListOf<HTMLInputElement>} [checkboxes.items] - Checkboxes query selector results\n */\n\n/**\n * @import { Schema } from 'govuk-frontend/dist/govuk/common/configuration.mjs'\n */\n"],"names":["MultiSelect","ConfigurableComponent","constructor","$root","config","_this$config$checkbox","$container","querySelector","idPrefix","$checkboxes","checkboxes","items","querySelectorAll","selector","HTMLElement","length","setupToggle","$toggleButton","$toggle","addEventListener","onButtonClick","bind","append","Array","from","forEach","$input","onCheckboxClick","checked","id","document","createElement","$label","$span","classList","add","type","setAttribute","textContent","uncheckAll","checkAll","event","target","HTMLInputElement","filter","moduleName","defaults","Object","freeze","schema","properties"],"mappings":";;;;;;EAEA;EACA;EACA;EACO,MAAMA,WAAW,SAASC,mCAAqB,CAAC;EACrD;EACF;EACA;EACA;EACEC,EAAAA,WAAWA,CAACC,KAAK,EAAEC,MAAM,GAAG,EAAE,EAAE;EAAA,IAAA,IAAAC,qBAAA;EAC9B,IAAA,KAAK,CAACF,KAAK,EAAEC,MAAM,CAAC;EAEpB,IAAA,MAAME,UAAU,GAAG,IAAI,CAACH,KAAK,CAACI,aAAa,CACzC,CAAA,CAAA,EAAI,IAAI,CAACH,MAAM,CAACI,QAAQ,YAC1B,CAAC;EAED,IAAA,MAAMC,WAAW,8CAAGJ,CAAAA,qBAAA,GAClB,IAAI,CAACD,MAAM,CAACM,UAAU,CAACC,KAAK,KAAAN,IAAAA,GAAAA,qBAAA,GAC1B,IAAI,CAACF,KAAK,CAACS,gBAAgB,CAAC,IAAI,CAACR,MAAM,CAACM,UAAU,CAACG,QAAQ,CAC9D;EAED,IAAA,IACE,CAACP,UAAU,IACX,EAAEA,UAAU,YAAYQ,WAAW,CAAC,IACpC,CAACL,WAAW,CAACM,MAAM,EACnB;EACA,MAAA,OAAO,IAAI;EACb;MAEA,IAAI,CAACC,WAAW,CAAC,IAAI,CAACZ,MAAM,CAACI,QAAQ,CAAC;MAEtC,IAAI,CAACS,aAAa,GAAG,IAAI,CAACC,OAAO,CAACX,aAAa,CAAC,OAAO,CAAC;EACxD,IAAA,IAAI,CAACU,aAAa,CAACE,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAACC,aAAa,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;MAE3E,IAAI,CAACf,UAAU,GAAGA,UAAU;MAC5B,IAAI,CAACA,UAAU,CAACgB,MAAM,CAAC,IAAI,CAACJ,OAAO,CAAC;MAEpC,IAAI,CAACT,WAAW,GAAGc,KAAK,CAACC,IAAI,CAACf,WAAW,CAAC;MAC1C,IAAI,CAACA,WAAW,CAACgB,OAAO,CAAEC,MAAM,IAC9BA,MAAM,CAACP,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAACQ,eAAe,CAACN,IAAI,CAAC,IAAI,CAAC,CAClE,CAAC;EAED,IAAA,IAAI,CAACO,OAAO,GAAGxB,MAAM,CAACwB,OAAO,IAAI,KAAK;EACxC;EAEAZ,EAAAA,WAAWA,CAACR,QAAQ,GAAG,EAAE,EAAE;EACzB,IAAA,MAAMqB,EAAE,GAAG,CAAGrB,EAAAA,QAAQ,CAAgB,cAAA,CAAA;EAEtC,IAAA,MAAMU,OAAO,GAAGY,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;EAC7C,IAAA,MAAMC,MAAM,GAAGF,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;EAC9C,IAAA,MAAML,MAAM,GAAGI,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;EAC9C,IAAA,MAAME,KAAK,GAAGH,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;MAE5Cb,OAAO,CAACgB,SAAS,CAACC,GAAG,CACnB,wBAAwB,EACxB,yBAAyB,EACzB,4BACF,CAAC;MAEDT,MAAM,CAACG,EAAE,GAAGA,EAAE;MACdH,MAAM,CAACU,IAAI,GAAG,UAAU;EACxBV,IAAAA,MAAM,CAACQ,SAAS,CAACC,GAAG,CAAC,yBAAyB,CAAC;EAE/CH,IAAAA,MAAM,CAACK,YAAY,CAAC,KAAK,EAAER,EAAE,CAAC;MAC9BG,MAAM,CAACE,SAAS,CAACC,GAAG,CAClB,aAAa,EACb,yBAAyB,EACzB,gCACF,CAAC;EAEDF,IAAAA,KAAK,CAACC,SAAS,CAACC,GAAG,CAAC,uBAAuB,CAAC;MAC5CF,KAAK,CAACK,WAAW,GAAG,YAAY;EAEhCN,IAAAA,MAAM,CAACV,MAAM,CAACW,KAAK,CAAC;EACpBf,IAAAA,OAAO,CAACI,MAAM,CAACI,MAAM,EAAEM,MAAM,CAAC;MAE9B,IAAI,CAACd,OAAO,GAAGA,OAAO;EACxB;EAEAE,EAAAA,aAAaA,GAAG;MACd,IAAI,IAAI,CAACQ,OAAO,EAAE;QAChB,IAAI,CAACW,UAAU,EAAE;EACjB,MAAA,IAAI,CAACtB,aAAa,CAACW,OAAO,GAAG,KAAK;EACpC,KAAC,MAAM;QACL,IAAI,CAACY,QAAQ,EAAE;EACf,MAAA,IAAI,CAACvB,aAAa,CAACW,OAAO,GAAG,IAAI;EACnC;EACF;EAEAY,EAAAA,QAAQA,GAAG;EACT,IAAA,IAAI,CAAC/B,WAAW,CAACgB,OAAO,CAAEC,MAAM,IAAK;QACnCA,MAAM,CAACE,OAAO,GAAG,IAAI;EACvB,KAAC,CAAC;MAEF,IAAI,CAACA,OAAO,GAAG,IAAI;EACrB;EAEAW,EAAAA,UAAUA,GAAG;EACX,IAAA,IAAI,CAAC9B,WAAW,CAACgB,OAAO,CAAEC,MAAM,IAAK;QACnCA,MAAM,CAACE,OAAO,GAAG,KAAK;EACxB,KAAC,CAAC;MAEF,IAAI,CAACA,OAAO,GAAG,KAAK;EACtB;;EAEA;EACF;EACA;IACED,eAAeA,CAACc,KAAK,EAAE;EACrB,IAAA,IAAI,EAAEA,KAAK,CAACC,MAAM,YAAYC,gBAAgB,CAAC,EAAE;EAC/C,MAAA;EACF;EAEA,IAAA,IAAI,CAACF,KAAK,CAACC,MAAM,CAACd,OAAO,EAAE;EACzB,MAAA,IAAI,CAACX,aAAa,CAACW,OAAO,GAAG,KAAK;QAClC,IAAI,CAACA,OAAO,GAAG,KAAK;EACtB,KAAC,MAAM;QACL,IACE,IAAI,CAACnB,WAAW,CAACmC,MAAM,CAAElB,MAAM,IAAKA,MAAM,CAACE,OAAO,CAAC,CAACb,MAAM,KAC1D,IAAI,CAACN,WAAW,CAACM,MAAM,EACvB;EACA,QAAA,IAAI,CAACE,aAAa,CAACW,OAAO,GAAG,IAAI;UACjC,IAAI,CAACA,OAAO,GAAG,IAAI;EACrB;EACF;EACF;;EAEA;EACF;EACA;EA6BA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EAzKa5B,WAAW,CA8Hf6C,UAAU,GAAG,kBAAkB;EAEtC;EACF;EACA;EACA;EACA;EApIa7C,WAAW,CAqIf8C,QAAQ,GAAGC,MAAM,CAACC,MAAM,CAAC;EAC9BxC,EAAAA,QAAQ,EAAE,EAAE;EACZE,EAAAA,UAAU,EAAE;EACVG,IAAAA,QAAQ,EAAE;EACZ;EACF,CAAC,CAAC;EAEF;EACF;EACA;EACA;EACA;EAhJab,WAAW,CAiJfiD,MAAM,GAAGF,MAAM,CAACC,MAAM,qBACL;EACpBE,EAAAA,UAAU,EAAE;EACV1C,IAAAA,QAAQ,EAAE;EAAE4B,MAAAA,IAAI,EAAE;OAAU;EAC5BR,IAAAA,OAAO,EAAE;EAAEQ,MAAAA,IAAI,EAAE;OAAW;EAC5B1B,IAAAA,UAAU,EAAE;EAAE0B,MAAAA,IAAI,EAAE;EAAS;EAC/B;EACF,CACF,CAAC;;;;;;;;"}