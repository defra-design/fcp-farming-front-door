{"version":3,"file":"sortable-table.mjs","sources":["../../../../src/moj/components/sortable-table/sortable-table.mjs"],"sourcesContent":["import { ConfigurableComponent } from 'govuk-frontend'\n\n/**\n * @augments {ConfigurableComponent<SortableTableConfig>}\n */\nexport class SortableTable extends ConfigurableComponent {\n  /**\n   * @param {Element | null} $root - HTML element to use for sortable table\n   * @param {SortableTableConfig} [config] - Sortable table config\n   */\n  constructor($root, config = {}) {\n    super($root, config)\n\n    const $head = $root?.querySelector('thead')\n    const $body = $root?.querySelector('tbody')\n\n    if (!$head || !$body) {\n      return this\n    }\n\n    this.$head = $head\n    this.$body = $body\n    this.$caption = this.$root.querySelector('caption')\n\n    this.$upArrow = `<svg width=\"22\" height=\"22\" focusable=\"false\" aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 22 22\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M6.5625 15.5L11 6.63125L15.4375 15.5H6.5625Z\" fill=\"currentColor\"/>\n</svg>`\n    this.$downArrow = `<svg width=\"22\" height=\"22\" focusable=\"false\" aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 22 22\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M15.4375 7L11 15.8687L6.5625 7L15.4375 7Z\" fill=\"currentColor\"/>\n</svg>`\n    this.$upDownArrow = `<svg width=\"22\" height=\"22\" focusable=\"false\" aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 22 22\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M8.1875 9.5L10.9609 3.95703L13.7344 9.5H8.1875Z\" fill=\"currentColor\"/>\n<path d=\"M13.7344 12.0781L10.9609 17.6211L8.1875 12.0781H13.7344Z\" fill=\"currentColor\"/>\n</svg>`\n\n    this.$headings = this.$head\n      ? Array.from(this.$head.querySelectorAll('th'))\n      : []\n\n    this.createHeadingButtons()\n    this.updateCaption()\n    this.updateDirectionIndicators()\n    this.createStatusBox()\n    this.initialiseSortedColumn()\n\n    this.$head.addEventListener('click', this.onSortButtonClick.bind(this))\n  }\n\n  createHeadingButtons() {\n    for (const $heading of this.$headings) {\n      if ($heading.hasAttribute('aria-sort')) {\n        this.createHeadingButton($heading)\n      }\n    }\n  }\n\n  /**\n   * @param {HTMLTableCellElement} $heading\n   */\n  createHeadingButton($heading) {\n    const index = this.$headings.indexOf($heading)\n    const $button = document.createElement('button')\n\n    $button.setAttribute('type', 'button')\n    $button.setAttribute('data-index', `${index}`)\n    $button.textContent = $heading.textContent\n\n    $heading.textContent = ''\n    $heading.appendChild($button)\n  }\n\n  createStatusBox() {\n    this.$status = document.createElement('div')\n\n    this.$status.setAttribute('aria-atomic', 'true')\n    this.$status.setAttribute('aria-live', 'polite')\n    this.$status.setAttribute('class', 'govuk-visually-hidden')\n    this.$status.setAttribute('role', 'status')\n\n    this.$root.insertAdjacentElement('afterend', this.$status)\n  }\n\n  initialiseSortedColumn() {\n    const $rows = this.getTableRowsArray()\n\n    const $heading = this.$root.querySelector(\n      'th[aria-sort=\"ascending\"], th[aria-sort=\"descending\"]'\n    )\n    const $sortButton = $heading?.querySelector('button')\n    const sortDirection = $heading?.getAttribute('aria-sort')\n\n    const columnNumber = Number.parseInt(\n      $sortButton?.getAttribute('data-index') ?? '0',\n      10\n    )\n\n    if (\n      !$heading ||\n      !$sortButton ||\n      !(sortDirection === 'ascending' || sortDirection === 'descending')\n    ) {\n      return\n    }\n\n    const $sortedRows = this.sort($rows, columnNumber, sortDirection)\n    this.addRows($sortedRows)\n  }\n\n  /**\n   * @param {MouseEvent} event - Click event\n   */\n  onSortButtonClick(event) {\n    const $target = /** @type {HTMLElement} */ (event.target)\n    const $button = $target.closest('button')\n\n    if (\n      !$button ||\n      !($button instanceof HTMLButtonElement) ||\n      !$button.parentElement\n    ) {\n      return\n    }\n\n    const $heading = $button.parentElement\n    const sortDirection = $heading.getAttribute('aria-sort')\n\n    const columnNumber = Number.parseInt(\n      $button?.getAttribute('data-index') ?? '0',\n      10\n    )\n\n    const newSortDirection =\n      sortDirection === 'none' || sortDirection === 'descending'\n        ? 'ascending'\n        : 'descending'\n\n    const $rows = this.getTableRowsArray()\n    const $sortedRows = this.sort($rows, columnNumber, newSortDirection)\n\n    this.addRows($sortedRows)\n    this.removeButtonStates()\n    this.updateButtonState($button, newSortDirection)\n    this.updateDirectionIndicators()\n  }\n\n  updateCaption() {\n    if (!this.$caption) {\n      return\n    }\n\n    let assistiveText = this.$caption.querySelector('.govuk-visually-hidden')\n    if (assistiveText) {\n      return\n    }\n\n    assistiveText = document.createElement('span')\n    assistiveText.classList.add('govuk-visually-hidden')\n    assistiveText.textContent = 'â€ˆ(column headers with buttons are sortable).'\n\n    this.$caption.appendChild(assistiveText)\n  }\n\n  /**\n   * @param {HTMLButtonElement} $button\n   * @param {string} direction\n   */\n  updateButtonState($button, direction) {\n    if (!(direction === 'ascending' || direction === 'descending')) {\n      return\n    }\n\n    $button.parentElement.setAttribute('aria-sort', direction)\n    let message = this.config.statusMessage\n    message = message.replace(/%heading%/, $button.textContent)\n    message = message.replace(/%direction%/, this.config[`${direction}Text`])\n    this.$status.textContent = message\n  }\n\n  updateDirectionIndicators() {\n    for (const $heading of this.$headings) {\n      const $button = /** @type {HTMLButtonElement} */ (\n        $heading.querySelector('button')\n      )\n      if ($heading.hasAttribute('aria-sort') && $button) {\n        const direction = $heading.getAttribute('aria-sort')\n        $button.querySelector('svg')?.remove()\n\n        switch (direction) {\n          case 'ascending':\n            $button.insertAdjacentHTML('beforeend', this.$upArrow)\n            break\n          case 'descending':\n            $button.insertAdjacentHTML('beforeend', this.$downArrow)\n            break\n          default:\n            $button.insertAdjacentHTML('beforeend', this.$upDownArrow)\n        }\n      }\n    }\n  }\n\n  removeButtonStates() {\n    for (const $heading of this.$headings) {\n      $heading.setAttribute('aria-sort', 'none')\n    }\n  }\n\n  /**\n   * @param {HTMLTableRowElement[]} $rows\n   */\n  addRows($rows) {\n    for (const $row of $rows) {\n      this.$body.append($row)\n    }\n  }\n\n  getTableRowsArray() {\n    return Array.from(this.$body.querySelectorAll('tr'))\n  }\n\n  /**\n   * @param {HTMLTableRowElement[]} $rows\n   * @param {number} columnNumber\n   * @param {string} sortDirection\n   */\n  sort($rows, columnNumber, sortDirection) {\n    return $rows.sort(($rowA, $rowB) => {\n      const $tdA = $rowA.querySelectorAll('td, th')[columnNumber]\n      const $tdB = $rowB.querySelectorAll('td, th')[columnNumber]\n\n      if (\n        !$tdA ||\n        !$tdB ||\n        !($tdA instanceof HTMLElement) ||\n        !($tdB instanceof HTMLElement)\n      ) {\n        return 0\n      }\n\n      const valueA =\n        sortDirection === 'ascending'\n          ? this.getCellValue($tdA)\n          : this.getCellValue($tdB)\n\n      const valueB =\n        sortDirection === 'ascending'\n          ? this.getCellValue($tdB)\n          : this.getCellValue($tdA)\n\n      return !(typeof valueA === 'number' && typeof valueB === 'number')\n        ? valueA.toString().localeCompare(valueB.toString())\n        : valueA - valueB\n    })\n  }\n\n  /**\n   * @param {HTMLElement} $cell\n   */\n  getCellValue($cell) {\n    const val = $cell.getAttribute('data-sort-value') || $cell.innerHTML\n    const valAsNumber = Number(val)\n\n    return Number.isFinite(valAsNumber)\n      ? valAsNumber // Exclude invalid numbers, infinity etc\n      : val\n  }\n\n  /**\n   * Name for the component used when initialising using data-module attributes.\n   */\n  static moduleName = 'moj-sortable-table'\n\n  /**\n   * Sortable table config\n   *\n   * @type {SortableTableConfig}\n   */\n  static defaults = Object.freeze({\n    statusMessage: 'Sort by %heading% (%direction%)',\n    ascendingText: 'ascending',\n    descendingText: 'descending'\n  })\n\n  /**\n   * Sortable table config schema\n   *\n   * @satisfies {Schema<SortableTableConfig>}\n   */\n  static schema = Object.freeze(\n    /** @type {const} */ ({\n      properties: {\n        statusMessage: { type: 'string' },\n        ascendingText: { type: 'string' },\n        descendingText: { type: 'string' }\n      }\n    })\n  )\n}\n\n/**\n * Sortable table config\n *\n * @typedef {object} SortableTableConfig\n * @property {string} [statusMessage] - Status message\n * @property {string} [ascendingText] - Ascending text\n * @property {string} [descendingText] - Descending text\n */\n\n/**\n * @import { Schema } from 'govuk-frontend/dist/govuk/common/configuration.mjs'\n */\n"],"names":["SortableTable","ConfigurableComponent","constructor","$root","config","$head","querySelector","$body","$caption","$upArrow","$downArrow","$upDownArrow","$headings","Array","from","querySelectorAll","createHeadingButtons","updateCaption","updateDirectionIndicators","createStatusBox","initialiseSortedColumn","addEventListener","onSortButtonClick","bind","$heading","hasAttribute","createHeadingButton","index","indexOf","$button","document","createElement","setAttribute","textContent","appendChild","$status","insertAdjacentElement","_$sortButton$getAttri","$rows","getTableRowsArray","$sortButton","sortDirection","getAttribute","columnNumber","Number","parseInt","$sortedRows","sort","addRows","event","_$button$getAttribute","$target","target","closest","HTMLButtonElement","parentElement","newSortDirection","removeButtonStates","updateButtonState","assistiveText","classList","add","direction","message","statusMessage","replace","_$button$querySelecto","remove","insertAdjacentHTML","$row","append","$rowA","$rowB","$tdA","$tdB","HTMLElement","valueA","getCellValue","valueB","toString","localeCompare","$cell","val","innerHTML","valAsNumber","isFinite","moduleName","defaults","Object","freeze","ascendingText","descendingText","schema","properties","type"],"mappings":"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"}